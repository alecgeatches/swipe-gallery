!function(){"use strict";var e=window.wp.blocks,l=JSON.parse('{"apiVersion":2,"name":"alecg/swipe-gallery","title":"Swipe Gallery","icon":"screenoptions","category":"media","editorScript":"alecg-swipe-gallery-editor","editorStyle":"file:./css/editor.css","style":"file:./css/frontend.css","attributes":{"images":{"type":"array","default":[]}}}');function t(){return t=Object.assign||function(e){for(var l=1;l<arguments.length;l++){var t=arguments[l];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},t.apply(this,arguments)}var a=window.wp.element,r=window.wp.i18n,i=window.wp.blockEditor,s=window.wp.primitives,n=window.wp.components,c=e=>{const[l,i]=(0,a.useState)(!1),{image:s,index:c,onRemoveClick:o}=e,m={key:c,"data-index":c};return 0!==s.url.indexOf("blob:")||s.id?(0,a.createElement)("figure",t({className:"swipe-gallery-item-loaded"},m),(0,a.createElement)("img",{src:s.url}),(0,a.createElement)("button",{className:"swipe-gallery-item-remove",title:(0,r.__)("Remove Image","alecg-swipe-gallery"),onClick:()=>i(!0)},(0,a.createElement)("span",{class:"dashicons dashicons-no-alt"})),l&&(0,a.createElement)(n.Modal,{className:"swipe-gallery-item-remove-modal",title:(0,r.__)("Remove image from gallery?","alecg-swipe-gallery"),onRequestClose:()=>i(!1)},(0,a.createElement)(n.Button,{variant:"primary",onClick:()=>(i(!1),void o(c))},(0,r.__)("Remove","alecg-swipe-gallery")),(0,a.createElement)(n.Button,{onClick:()=>i(!1)},(0,r.__)("Cancel","alecg-swipe-gallery")))):(0,a.createElement)("figure",t({className:"swipe-gallery-item-loading"},m),(0,a.createElement)("img",{src:s.url}),(0,a.createElement)(n.Spinner,null))};const{name:o}=l;(0,e.registerBlockType)(o,{edit:e=>{var l;const{attributes:n,setAttributes:o,isSelected:m}=e,d=(0,i.useBlockProps)(),[p,g]=(0,a.useState)(null!==(l=n.images)&&void 0!==l?l:[]),u=(0,a.useRef)();function w(e){return 0===e.url.indexOf("blob:")&&!e.id}function y(e){const l=[...p.slice(0,e),...p.slice(e+1)];g(l)}(0,a.useEffect)((()=>{jQuery(u.current).sortable({cursor:"grabbing",disabled:!0,placeholder:"swipe-gallery-drag-placeholder",tolerance:"pointer"})}),[]),(0,a.useEffect)((()=>{const e=jQuery(u.current);e.sortable("option","stop",((l,t)=>{const a=[...t.item.get(0).parentElement.children].map((e=>e.dataset.index)).map((e=>p[e]));e.sortable("cancel"),g(a)}))}),[p]),(0,a.useEffect)((()=>{const e=p.filter((e=>!w(e)));o({images:e});const l=e.length!==p.length;jQuery(u.current).sortable("option","disabled",l)}),[p]);const f={allowedTypes:["image"],multiple:!0,onSelect:function(e){const l=lodash.uniqBy([...p,...e],(e=>e.id?e.id:e.url)).map((e=>({id:e.id,url:e.url})));g(l)}};if(0===p.length)return(0,a.createElement)(s.View,d,(0,a.createElement)(i.MediaPlaceholder,t({},f,{labels:{title:(0,r.__)("Swipe Gallery","alecg-swipe-gallery"),instructions:(0,r.__)("Drag, upload, or select images to be displayed in the gallery.","alecg-swipe-gallery")}})));{const e=p.some(w),l=p.length%4;return(0,a.createElement)(s.View,d,(0,a.createElement)("div",{className:`swipe-gallery swipe-gallery-last-row-${l}`,ref:u},p.map(((e,l)=>(0,a.createElement)(c,{image:e,index:l,onRemoveClick:y})))),!m&&!e&&(0,a.createElement)("p",{className:"swipe-gallery-upload-text"},(0,r.__)("Add to swipe gallery...","alecg-swipe-gallery")),m&&!e&&(0,a.createElement)(i.MediaPlaceholder,t({},f,{className:"swipe-gallery-append-media-placeholder",isAppender:!0,labels:{instructions:!1,title:!1}})))}},save:e=>{var l;const t=i.useBlockProps.save(),{attributes:r}=e,n=null!==(l=r.images)&&void 0!==l?l:[];return(0,a.createElement)(s.View,t,(0,a.createElement)("ul",null,n.map((e=>(0,a.createElement)("li",null,(0,a.createElement)("div",{class:"swipe-gallery-media-item","data-id":e.id},e.id))))))}})}();