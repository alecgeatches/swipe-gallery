!function(){"use strict";var e=window.wp.blocks,t=JSON.parse('{"apiVersion":2,"name":"alecg/swipe-gallery","title":"Swipe Gallery","icon":"screenoptions","category":"media","editorScript":"alecg-swipe-gallery-editor","editorStyle":"file:./css/editor.css","style":"file:./css/frontend.css","attributes":{"images":{"type":"array","default":[]}}}');function l(){return l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r])}return e},l.apply(this,arguments)}var r=window.wp.element,a=window.wp.i18n,i=window.wp.blockEditor,n=window.wp.primitives,s=window.wp.components,c=e=>{const{image:t,index:a}=e,i={key:a,"data-index":a};return 0!==t.url.indexOf("blob:")||t.id?(0,r.createElement)("figure",i,(0,r.createElement)("img",{src:t.url})):(0,r.createElement)("figure",l({className:"swipe-gallery-item-loading"},i),(0,r.createElement)("img",{src:t.url}),(0,r.createElement)(s.Spinner,null))};const{name:o}=t;(0,e.registerBlockType)(o,{edit:e=>{var t;const{attributes:s,setAttributes:o,isSelected:d}=e,p=(0,i.useBlockProps)(),[u,m]=(0,r.useState)(null!==(t=s.images)&&void 0!==t?t:[]),g=(0,r.useRef)();function w(e){return 0===e.url.indexOf("blob:")&&!e.id}(0,r.useEffect)((()=>{jQuery(g.current).sortable({placeholder:"swipe-gallery-drag-placeholder",cursor:"grabbing",tolerance:"pointer"})}),[]),(0,r.useEffect)((()=>{const e=jQuery(g.current);e.sortable("option","stop",((t,l)=>{const r=[...l.item.get(0).parentElement.children].map((e=>e.dataset.index)).map((e=>u[e]));e.sortable("cancel"),m(r)}))}),[u]),(0,r.useEffect)((()=>{const e=u.filter((e=>!w(e)));o({images:e})}),[u]);const y={allowedTypes:["image"],multiple:!0,onSelect:function(e){const t=lodash.uniqBy([...u,...e],(e=>e.id?e.id:e.url)).map((e=>({id:e.id,url:e.url})));m(t)}};if(0===u.length)return(0,r.createElement)(n.View,p,(0,r.createElement)(i.MediaPlaceholder,l({},y,{labels:{title:(0,a.__)("Swipe Gallery","swipe-gallery"),instructions:(0,a.__)("Drag, upload, or select images to be displayed in the gallery.")}})));{const e=u.some(w),t=u.length%4;return(0,r.createElement)(n.View,p,(0,r.createElement)("div",{className:`swipe-gallery swipe-gallery-last-row-${t}`,ref:g},u.map(((e,t)=>(0,r.createElement)(c,{image:e,index:t})))),!d&&!e&&(0,r.createElement)("p",{className:"swipe-gallery-upload-text"},(0,a.__)("Add to swipe gallery...")),d&&!e&&(0,r.createElement)(i.MediaPlaceholder,l({},y,{className:"swipe-gallery-append-media-placeholder",isAppender:!0,labels:{instructions:!1,title:!1}})))}},save:e=>{var t;const l=i.useBlockProps.save(),{attributes:a}=e,s=null!==(t=a.images)&&void 0!==t?t:[];return(0,r.createElement)(n.View,l,(0,r.createElement)("ul",null,s.map((e=>(0,r.createElement)("li",null,(0,r.createElement)("div",{class:"swipe-gallery-media-item","data-id":e.id},e.id))))))}})}();