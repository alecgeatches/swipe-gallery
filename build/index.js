!function(){"use strict";var e={n:function(t){var l=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(l,{a:l}),l},d:function(t,l){for(var a in l)e.o(l,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:l[a]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},t=window.wp.blocks,l=JSON.parse('{"apiVersion":2,"name":"alecg/swipe-gallery","title":"Swipe Gallery","icon":"screenoptions","category":"media","editorScript":"alecg-swipe-gallery-editor-js","editorStyle":"file:./css/editor.css","style":"alecg-swipe-gallery-frontend-css","script":"alecg-swipe-gallery-frontend-js","attributes":{"images":{"type":"array","default":[]},"aspectRatio":{"enum":["16-9","4-3","3-2","1-1"],"default":"3-2"},"desktopItemsPerRow":{"type":"integer","default":4},"mobileItemsPerRow":{"type":"integer","default":2}}}');function a(){return a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a])}return e},a.apply(this,arguments)}var s=window.wp.element,r=window.wp.i18n,i=window.wp.blockEditor,n=window.wp.primitives,o=window.lodash,c=e.n(o),p=window.wp.compose,m=window.jQuery,d=e.n(m),u=e=>{const{items:t,onItemsChange:l,children:a,isDisabled:r=!1,desktopItemsPerRow:i,mobileItemsPerRow:n}=e,o=(0,s.useRef)(),c=(0,p.useRefEffect)((e=>{const t=d()(e).sortable({cursor:"grabbing",tolerance:"pointer",classes:{"ui-sortable-helper":"item-dragged","ui-sortable-placeholder":"sortable-gallery-item"},placeholder:"item-placeholder",appendTo:d()(e).closest(".wp-block-alecg-swipe-gallery"),disabled:r});return()=>{t.sortable("destroy")}}),[]),m=(0,p.useMergeRefs)([o,c]);if((0,s.useEffect)((()=>{if(void 0===o.current)return;const e=d()(o.current);e.sortable("option","stop",((a,s)=>{const r=[...s.item.get(0).parentElement.children].map((e=>e.dataset.id)).map((e=>t[e]));e.sortable("cancel"),l(r)}))}),[t]),(0,s.useEffect)((()=>{o.current&&d()(o.current).sortable("option","disabled",r)}),[r]),0===t.length)return null;{const e=`sortable-items-per-row-desktop-${i}`,o=`sortable-items-per-row-mobile-${n}`;return(0,s.createElement)("div",{className:`sortable-gallery ${e} ${o} ${r&&"sortable-gallery-disabled"}`,ref:m},a.map(((e,a)=>(e.props.onRemoveClick=()=>function(e){const a=[...t.slice(0,e),...t.slice(e+1)];l(a)}(a),(0,s.createElement)("div",{className:"sortable-gallery-item",key:a,"data-id":a},e)))))}},w=window.wp.components,_=e=>{const[t,l]=(0,s.useState)(!1),{image:i,index:n,onRemoveClick:o,aspectRatio:c}=e,p=`swipe-gallery-item-aspect-ratio-${c}`,m={"data-id":n};return 0!==i.url.indexOf("blob:")||i.id?(0,s.createElement)("figure",a({className:`swipe-gallery-item swipe-gallery-item-loaded ${p}`},m),(0,s.createElement)("img",{src:i.url,alt:i.title||""}),(0,s.createElement)("button",{className:"swipe-gallery-item-remove",title:(0,r.__)("Remove Image","alecg-swipe-gallery"),onClick:()=>l(!0)},(0,s.createElement)("span",{class:"dashicons dashicons-no-alt"})),t&&(0,s.createElement)(w.Modal,{className:"swipe-gallery-item-remove-modal",title:(0,r.__)("Remove image from gallery?","alecg-swipe-gallery"),onRequestClose:()=>l(!1)},(0,s.createElement)(w.Button,{variant:"primary",onClick:()=>(l(!1),void o(n))},(0,r.__)("Remove","alecg-swipe-gallery")),(0,s.createElement)(w.Button,{onClick:()=>l(!1)},(0,r.__)("Cancel","alecg-swipe-gallery")))):(0,s.createElement)("figure",a({className:`swipe-gallery-item swipe-gallery-item-loading ${p}`},m),(0,s.createElement)("img",{src:i.url}),(0,s.createElement)(w.Spinner,null))},g=e=>{const{attributes:t,setAttributes:l}=e,{aspectRatio:a,desktopItemsPerRow:n,mobileItemsPerRow:o}=t,c=[{value:"16-9",label:(0,r.__)("16:9")},{value:"4-3",label:(0,r.__)("4:3")},{value:"3-2",label:(0,r.__)("3:2")},{value:"1-1",label:(0,r.__)("1:1")}];return(0,s.createElement)(i.InspectorControls,null,(0,s.createElement)(w.PanelBody,{title:(0,r.__)("Display Settings")},(0,s.createElement)(w.SelectControl,{label:(0,r.__)("Thumbnail Aspect Ratio"),value:a,onChange:function(e){l({aspectRatio:e})},options:c}),(0,s.createElement)(w.RangeControl,{label:(0,r.__)("Items per Row on Desktop"),value:n,onChange:function(e){l({desktopItemsPerRow:e})},min:1,max:6}),(0,s.createElement)(w.RangeControl,{label:(0,r.__)("Items per Row on Mobile"),value:o,onChange:function(e){l({mobileItemsPerRow:e})},min:1,max:6})))},b=()=>(0,s.createElement)("div",{class:"pswp",tabindex:"-1",role:"dialog","aria-hidden":"true"},(0,s.createElement)("div",{class:"pswp__bg"}),(0,s.createElement)("div",{class:"pswp__scroll-wrap"},(0,s.createElement)("div",{class:"pswp__container"},(0,s.createElement)("div",{class:"pswp__item"}),(0,s.createElement)("div",{class:"pswp__item"}),(0,s.createElement)("div",{class:"pswp__item"})),(0,s.createElement)("div",{class:"pswp__ui pswp__ui--hidden"},(0,s.createElement)("div",{class:"pswp__top-bar"},(0,s.createElement)("div",{class:"pswp__counter"}),(0,s.createElement)("button",{class:"pswp__button pswp__button--close",title:"Close (Esc)"}),(0,s.createElement)("button",{class:"pswp__button pswp__button--share",title:"Share"}),(0,s.createElement)("button",{class:"pswp__button pswp__button--fs",title:"Toggle fullscreen"}),(0,s.createElement)("button",{class:"pswp__button pswp__button--zoom",title:"Zoom in/out"}),(0,s.createElement)("div",{class:"pswp__preloader"},(0,s.createElement)("div",{class:"pswp__preloader__icn"},(0,s.createElement)("div",{class:"pswp__preloader__cut"},(0,s.createElement)("div",{class:"pswp__preloader__donut"}))))),(0,s.createElement)("div",{class:"pswp__share-modal pswp__share-modal--hidden pswp__single-tap"},(0,s.createElement)("div",{class:"pswp__share-tooltip"})),(0,s.createElement)("button",{class:"pswp__button pswp__button--arrow--left",title:"Previous (arrow left)"}),(0,s.createElement)("button",{class:"pswp__button pswp__button--arrow--right",title:"Next (arrow right)"}),(0,s.createElement)("div",{class:"pswp__caption"},(0,s.createElement)("div",{class:"pswp__caption__center"})))));const{name:E}=l;(0,t.registerBlockType)(E,{edit:e=>{const{attributes:t,setAttributes:l,isSelected:o}=e,p=(0,i.useBlockProps)(),[m,d]=(0,s.useState)(t.images||[]);(0,s.useEffect)((()=>{const e=m.filter((e=>e.id&&e.url&&e.thumbnailUrl&&e.width&&e.height));l({images:e})}),[m]);const w={allowedTypes:["image"],multiple:!0,onSelect:function(e){const t=c().uniqBy([...m,...e],(e=>e.id?e.id:e.url)).map((e=>{var t,l;const{width:a,height:s}=e.media_details?e.media_details:e,r=e.media_details?null===(t=e.media_details.sizes)||void 0===t||null===(l=t.medium)||void 0===l?void 0:l.source_url:e.thumbnailUrl;return{id:e.id,url:e.url,title:e.title,thumbnailUrl:r,width:a,height:s}}));d(t)}},b=(0,s.createElement)(g,{attributes:t,setAttributes:l});if(0===m.length)return(0,s.createElement)(n.View,p,b,(0,s.createElement)(i.MediaPlaceholder,a({},w,{labels:{title:(0,r.__)("Swipe Gallery","alecg-swipe-gallery"),instructions:(0,r.__)("Drag, upload, or select images to be displayed in the gallery.","alecg-swipe-gallery")}})));{const e=m.some((function(e){return 0===e.url.indexOf("blob:")&&!e.id}));return(0,s.createElement)(n.View,p,b,(0,s.createElement)(u,{items:m,onItemsChange:function(e){d(e)},isDisabled:e,desktopItemsPerRow:t.desktopItemsPerRow,mobileItemsPerRow:t.mobileItemsPerRow},m.map((e=>(0,s.createElement)(_,{image:e,aspectRatio:t.aspectRatio})))),!o&&!e&&(0,s.createElement)("p",{className:"swipe-gallery-upload-text"},(0,r.__)("Add to swipe gallery...","alecg-swipe-gallery")),o&&!e&&(0,s.createElement)(i.MediaPlaceholder,a({},w,{className:"swipe-gallery-append-media-placeholder",isAppender:!0,labels:{instructions:!1,title:!1}})))}},save:e=>{const t=i.useBlockProps.save(),{attributes:l}=e,{aspectRatio:a,desktopItemsPerRow:r,mobileItemsPerRow:o,images:c=[]}=l,p=`swipe-gallery-item-aspect-ratio-${a}`,m=`swipe-items-per-row-desktop-${r}`,d=`swipe-items-per-row-mobile-${o}`;return(0,s.createElement)(n.View,t,(0,s.createElement)("div",{class:`swipe-gallery ${m} ${d}`},c.map((e=>(0,s.createElement)("figure",{class:`swipe-gallery-item ${p}`},(0,s.createElement)("img",{loading:"lazy",src:e.url,alt:e.title||"","data-width":e.width,"data-height":e.height,"data-thumbnail-url":e.thumbnailUrl}))))),(0,s.createElement)(b,null))}})}();